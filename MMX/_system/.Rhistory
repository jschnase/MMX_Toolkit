# ------------------------------------------------------------------------------
#
# subset.R
# - subsets mmx base_collection files to create a working_set collection
# - https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007544.html
#
# ------------------------------------------------------------------------------
library(raster)
library(ncdf4)
bc_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Development/MMX/base_collection"
ws_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/WS_TimeSeries_Year"
mask     <- raster("/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/_mask.asc")
ext      <- extent(-119, -97.1, 23.9, 40.8)
year     <- 1981                                 # <<< insert year here!
files    <- list.files(bc_dir, pattern="1981")   # <<< insert year here!
for (var in files) {
r <- raster(paste0(bc_dir, "/", var ))
s <- raster(r)
res(s) <- min(res(s))
s = resample(r, s,  method='bilinear')
c <- crop(s, ext)
m <- mask(c, mask)
dir.create(paste0(ws_dir, "/", year))
writeRaster(m, filename=paste0(ws_dir, "/", year, "/", gsub(".nc", ".asc", var)), format="ascii", overwrite=TRUE)
}
warnings()
library(raster)
library(ncdf4)
bc_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Development/MMX/base_collection"
ws_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/WS_TimeSeries_Year"
mask     <- raster("/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/_mask.asc")
ext      <- extent(-119, -97.1, 23.9, 40.8)
year     <- 1981                                 # <<< insert year here!
files    <- list.files(bc_dir, pattern="1981")   # <<< insert year here!
dir.create(paste0(ws_dir, "/", year))
for (var in files) {
r <- raster(paste0(bc_dir, "/", var ))
s <- raster(r)
res(s) <- min(res(s))
s = resample(r, s,  method='bilinear')
c <- crop(s, ext)
m <- mask(c, mask)
writeRaster(m, filename=paste0(ws_dir, "/", year, "/", gsub(".nc", ".asc", var)), format="ascii", overwrite=TRUE)
}
rm(list=ls())
# ------------------------------------------------------------------------------
#
# subset.R
# - subsets mmx base_collection files to create a working_set collection
# - https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007544.html
#
# ------------------------------------------------------------------------------
rm(list=ls())
library(raster)
library(ncdf4)
bc_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Development/MMX/base_collection"
ws_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/WS_TimeSeries_Year"
mask     <- raster("/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/_mask.asc")
ext      <- extent(-119, -97.1, 23.9, 40.8)
year     <- 1980                                 # <<< insert year here!
files    <- list.files(bc_dir, pattern="1980")   # <<< insert year here!
dir.create(paste0(ws_dir, "/", year))
for (var in files) {
r <- raster(paste0(bc_dir, "/", var ))
s <- raster(r)
res(s) <- min(res(s))
s = resample(r, s,  method='bilinear')
c <- crop(s, ext)
m <- mask(c, mask)
writeRaster(m, filename=paste0(ws_dir, "/", year, "/", gsub(".nc", ".asc", var)), format="ascii", overwrite=TRUE)
}
# ------------------------------------------------------------------------------
#
# subset.R
# - subsets mmx base_collection files to create a working_set collection
# - https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007544.html
#
# ------------------------------------------------------------------------------
rm(list=ls())
library(raster)
library(ncdf4)
bc_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Development/MMX/base_collection"
ws_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/WS_TimeSeries_Year"
mask     <- raster("/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/_mask.asc")
ext      <- extent(-119, -97.1, 23.9, 40.8)
year     <- 1982                                 # <<< insert year here!
files    <- list.files(bc_dir, pattern="1982")   # <<< insert year here!
dir.create(paste0(ws_dir, "/", year))
for (var in files) {
r <- raster(paste0(bc_dir, "/", var ))
s <- raster(r)
res(s) <- min(res(s))
s = resample(r, s,  method='bilinear')
c <- crop(s, ext)
m <- mask(c, mask)
writeRaster(m, filename=paste0(ws_dir, "/", year, "/", gsub(".nc", ".asc", var)), format="ascii", overwrite=TRUE)
}
list.files(bc_dir, pattern="1982")
files    <- list.files(bc_dir, pattern=paste0('"', year, '"'))   # <<< insert year here!
files
# ------------------------------------------------------------------------------
#
# subset.R
# - subsets mmx base_collection files to create a working_set collection
# - https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007544.html
#
# ------------------------------------------------------------------------------
rm(list=ls())
library(raster)
library(ncdf4)
bc_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Development/MMX/base_collection"
ws_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/WS_TimeSeries_Year"
mask     <- raster("/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/_mask.asc")
ext      <- extent(-119, -97.1, 23.9, 40.8)
year     <- 1983                                 # <<< insert year here!
files    <- list.files(bc_dir, pattern="1983")   # <<< insert year here!
dir.create(paste0(ws_dir, "/", year))
for (var in files) {
r <- raster(paste0(bc_dir, "/", var ))
s <- raster(r)
res(s) <- min(res(s))
s = resample(r, s,  method='bilinear')
c <- crop(s, ext)
m <- mask(c, mask)
writeRaster(m, filename=paste0(ws_dir, "/", year, "/", gsub(".nc", ".asc", var)), format="ascii", overwrite=TRUE)
}
# ------------------------------------------------------------------------------
#
# subset.R
# - subsets mmx base_collection files to create a working_set collection
# - https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007544.html
#
# ------------------------------------------------------------------------------
rm(list=ls())
library(raster)
library(ncdf4)
bc_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Development/MMX/base_collection"
ws_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/WS_TimeSeries_Year"
mask     <- raster("/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/_mask.asc")
ext      <- extent(-119, -97.1, 23.9, 40.8)
year     <- 1984                                 # <<< insert year here!
files    <- list.files(bc_dir, pattern="1984")   # <<< insert year here!
dir.create(paste0(ws_dir, "/", year))
for (var in files) {
r <- raster(paste0(bc_dir, "/", var ))
s <- raster(r)
res(s) <- min(res(s))
s = resample(r, s,  method='bilinear')
c <- crop(s, ext)
m <- mask(c, mask)
writeRaster(m, filename=paste0(ws_dir, "/", year, "/", gsub(".nc", ".asc", var)), format="ascii", overwrite=TRUE)
}
list.files(path = bc_dir, pattern = past0(year, ".nc"))
list.files(path = bc_dir, pattern = paste0(year, ".nc"))
start_yr <- 1985
stop_yr  <- 1987
for (year in start_yr:stop_yr) {
print(year)
}
start_yr <- 1985
stop_yr  <- 1987
for (year in start_yr:stop_yr) {
list.files(path = bc_dir, pattern = paste0(year, ".nc"))
}
list.files(path = bc_dir, pattern = paste0(year, ".nc"))
for (year in start_yr:stop_yr) {
list.files(path = bc_dir, pattern = paste0(year, ".nc"))
}
for (year in start_yr:stop_yr) {
list.files(path = bc_dir, pattern = paste0(year, ".nc"))
}
# <<< insert year here!
files    <- list.files(bc_dir, pattern="1984")   # <<< insert year here!
list.files(path = bc_dir, pattern = paste0(year, ".nc"))
rm()
for (year in start_yr:stop_yr) {
print(year)
list.files(path = bc_dir, pattern = paste0(year, ".nc"))
}
rm(list=ls())
library(raster)
library(ncdf4)
bc_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Development/MMX/base_collection"
ws_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/WS_TimeSeries_Year"
mask     <- raster("/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/_mask.asc")
ext      <- extent(-119, -97.1, 23.9, 40.8)
start_yr <- 1985
stop_yr  <- 1987
for (year in start_yr:stop_yr) {
dir.create(paste0(ws_dir, "/", year))
files <- list.files(path = bc_dir, pattern = paste0(year, ".nc"))
for (var in files) {
r <- raster(paste0(bc_dir, "/", var ))
s <- raster(r)
res(s) <- min(res(s))
s = resample(r, s,  method='bilinear')
c <- crop(s, ext)
m <- mask(c, mask)
writeRaster(m, filename=paste0(ws_dir, "/", year, "/", gsub(".nc", ".asc", var)), format="ascii", overwrite=TRUE)
}
}
# ------------------------------------------------------------------------------
#
# subset.R
# - subsets mmx base_collection files to create a working_set collection
# - https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007544.html
#
# ------------------------------------------------------------------------------
rm(list=ls())
library(raster)
library(ncdf4)
bc_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Development/MMX/base_collection"
ws_dir   <- "/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/WS_TimeSeries_Year"
mask     <- raster("/Users/jschnase/Dropbox/MMX-Project/MMX-Experiments/Exp102/_mask.asc")
ext      <- extent(-119, -97.1, 23.9, 40.8)
start_yr <- 1988
stop_yr  <- 2021
for (year in start_yr:stop_yr) {
dir.create(paste0(ws_dir, "/", year))
files <- list.files(path = bc_dir, pattern = paste0(year, ".nc"))
for (var in files) {
r <- raster(paste0(bc_dir, "/", var ))
s <- raster(r)
res(s) <- min(res(s))
s = resample(r, s,  method='bilinear')
c <- crop(s, ext)
m <- mask(c, mask)
writeRaster(m, filename=paste0(ws_dir, "/", year, "/", gsub(".nc", ".asc", var)), format="ascii", overwrite=TRUE)
}
}
